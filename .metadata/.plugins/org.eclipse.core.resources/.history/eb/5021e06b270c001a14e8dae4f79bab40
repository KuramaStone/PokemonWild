package me.brook.PokemonCreator;

import java.io.IOException;

import javax.swing.JFrame;

import me.brook.PokemonCreator.graphics.PokeDrawer;
import me.brook.PokemonCreator.graphics.PokeWindow;
import me.brook.PokemonCreator.input.PokeMaker;
import me.brook.PokemonCreator.world.PokeWorld;
import me.brook.PokemonCreator.world.tile.TileType;

public class PokemonCreator implements Runnable {

	private JFrame frame;

	private PokeMaker maker;
	private PokeWorld world;
	private PokeWindow window;
	private PokeDrawer drawer;

	public PokemonCreator() throws IOException {
		drawer = new PokeDrawer(PokeWindow.SIZE);
		TileType.loadTileData();
		world = new PokeWorld(this);
		maker = new PokeMaker(this);
		window = new PokeWindow(this);
	}

	@Override
	public void run() {

		long lastUpdate = System.currentTimeMillis();
		while(true) {

			if(lastUpdate + (1000/100) <= System.currentTimeMillis()) {
				maker.tick(window.getMouseInput());
				world.tick();

				// Rendering
				drawer.drawWorld(world);
				drawer.repaint();
				
				lastUpdate = System.currentTimeMillis();
			}

		}

	}

	public PokeWindow getWindow() {
		return window;
	}

	public PokeWorld getWorld() {
		return world;
	}
	
	public PokeMaker getMaker() {
		return maker;
	}
	
	public PokeDrawer getDrawer() {
		return drawer;
	}
	
	public JFrame getFrame() {
		return frame;
	}

}
