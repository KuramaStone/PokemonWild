package me.brook.PokemonCreator.graphics;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.image.BufferedImage;

import me.brook.PokemonCreator.world.PokeWorld;
import me.brook.PokemonCreator.world.area.PokeArea;
import me.brook.PokemonCreator.world.tile.Tile;

public class PokeDrawer {

	private PokeWindow window;
	
	private boolean highlightTiles = false;
	private BufferedImage buffer;

	public PokeDrawer(PokeWindow pokeWindow) {
		this.window = pokeWindow;
		buffer = new BufferedImage(512, 512, BufferedImage.TYPE_INT_RGB);
	}

	/*
	 * Draw the areas
	 */
	public void drawWorld(PokeWorld world) {

		for(PokeArea area : world.getAreas()) {

			int offsetX = area.getOffsetX() * getTileSize() + xOffset;
			int offsetY = area.getOffsetY() * getTileSize() + yOffset;

			int width = area.getWidth();

			Tile[] tiles = area.getTiles();
			for(int i = 0; i < tiles.length; i++) {
				Tile tile = tiles[i];

				int x = (i % width) * getTileSize();
				int y = (i / width) * getTileSize();

				int tx = x + offsetX;
				int ty = y + offsetY;
				drawTile(tx, ty, tile);
			}

		}
		// for(int i = 0; i < inventory.getInventory().size(); i++) {
		// drawTile(0, 0, i);
		// }

	}

	private void drawTile(int tx, int ty, Tile tile) {
		Graphics g = buffer.getGraphics();
		BufferedImage image = tile.getCurrentImage();

		g.drawImage(image, tx, ty, getTileSize(), getTileSize(), null);

		if(highlightTiles) {
			g.setColor(Color.RED);
			g.drawRect(tx, ty, getTileSize(), getTileSize());
		}
	}

	private int getTileSize() {
		return SIZE / 15; // 15x15 tiles per screen
	}
	
	public boolean highlightTiles() {
		return highlightTiles;
	}

}
